# 视频处理工具使用说明

本工具集包含多个视频处理脚本，用于批量处理、合并和分析视频文件。

## 📁 目录结构

```
根目录/
├── merge_videos_fixed.sh          # 单一分辨率视频合并脚本
├── merge_videos_classified.sh     # 分类合并脚本（横屏/竖屏）
├── list_video_resolutions.sh      # 视频分辨率分析脚本
├── split_videos.sh               # 视频分割脚本
├── 已处理/                       # 处理完成的原始视频存放目录
└── output/                       # 输出文件目录
```

## 🛠️ 前置要求

- **ffmpeg**: 必须安装 ffmpeg 工具
  ```bash
  # macOS 安装
  brew install ffmpeg
  
  # Ubuntu/Debian 安装
  sudo apt update && sudo apt install ffmpeg
  ```

## 📋 脚本功能说明

### 1. merge_videos_fixed.sh - 统一分辨率合并

**功能**: 将所有视频标准化为统一分辨率（1920x1088）并合并为单个文件

**特点**:
- 使用模糊背景填充，替代传统黑边
- 保持原始视频宽高比
- 自动生成随机文件名

**使用方法**:
```bash
# 将视频文件放入当前目录
# 执行脚本
./merge_videos_fixed.sh
```

**输出**: `output/merged_video_[随机码].mp4`

### 2. merge_videos_classified.sh - 分类合并

**功能**: 自动识别横屏/竖屏视频，分别合并为不同文件

**分辨率设置**:
- 横屏视频: 1920x1088
- 竖屏视频: 1088x1920

**特点**:
- 智能分类横屏/竖屏视频
- 使用模糊背景填充效果
- 生成两个独立的合并文件

**使用方法**:
```bash
./merge_videos_classified.sh
```

**输出**:
- `output/merged_landscape_[随机码].mp4` (横屏合并)
- `output/merged_portrait_[随机码].mp4` (竖屏合并)

### 3. list_video_resolutions.sh - 分辨率分析

**功能**: 分析目录中所有视频的分辨率信息

**使用方法**:
```bash
./list_video_resolutions.sh
```

**输出信息**:
- 文件名
- 分辨率 (宽x高)
- 视频时长
- 文件大小

### 4. split_videos.sh - 视频分割

**功能**: 将视频按指定时长分割为多个片段

**使用方法**:
```bash
./split_videos.sh
```

## 🎯 使用流程

### 基本工作流程

1. **准备视频文件**
   - 将需要处理的视频文件放入当前目录
   - 支持格式: mp4, avi, mov, mkv, flv, wmv, m4v

2. **选择处理方式**
   - 统一合并: 使用 `merge_videos_fixed.sh`
   - 分类合并: 使用 `merge_videos_classified.sh`
   - 仅分析: 使用 `list_video_resolutions.sh`

3. **执行脚本**
   ```bash
   # 给脚本添加执行权限
   chmod +x *.sh
   
   # 执行相应脚本
   ./merge_videos_fixed.sh
   ```

4. **查看结果**
   - 合并后的视频在 `output/` 目录
   - 原始视频自动移动到 `已处理/` 目录

## ⚙️ 高级配置

### 修改目标分辨率

编辑脚本文件，修改以下变量:

```bash
# merge_videos_fixed.sh
TARGET_WIDTH=1920
TARGET_HEIGHT=1088

# merge_videos_classified.sh
LANDSCAPE_WIDTH=1920
LANDSCAPE_HEIGHT=1088
PORTRAIT_WIDTH=1088
PORTRAIT_HEIGHT=1920
```

### 调整模糊效果

修改 `boxblur` 参数:
```bash
# 当前设置: boxblur=12:2
# 格式: boxblur=半径:强度
# 半径越大模糊越强，强度影响处理质量
```

## 🚨 注意事项

1. **备份重要文件**: 原始视频会被移动到 `已处理/` 目录
2. **磁盘空间**: 确保有足够空间存储处理后的视频
3. **处理时间**: 大文件处理可能需要较长时间
4. **文件格式**: 输出统一为 MP4 格式
5. **权限问题**: 确保脚本有执行权限

## 🔧 故障排除

### 常见问题

**问题**: `ffmpeg: command not found`
**解决**: 安装 ffmpeg
```bash
brew install ffmpeg  # macOS
```

**问题**: 脚本无法执行
**解决**: 添加执行权限
```bash
chmod +x *.sh
```

**问题**: 视频处理失败
**解决**: 
1. 检查视频文件是否损坏
2. 确认磁盘空间充足
3. 查看终端错误信息

**问题**: 模糊效果不明显
**解决**: 调整 `boxblur` 参数，增大半径值

## 📊 性能优化建议

1. **批量处理**: 一次处理多个文件比单独处理更高效
2. **硬件加速**: 如有 GPU，可考虑启用硬件加速
3. **存储**: 使用 SSD 可显著提升处理速度
4. **内存**: 处理大文件时确保有足够内存

## 📝 更新日志

- **v1.0**: 基础合并功能
- **v1.1**: 添加分类合并功能
- **v1.2**: 引入模糊背景填充效果
- **v1.3**: 优化随机码生成机制

---

如有问题或建议，请查看脚本源码或联系开发者。
```
        